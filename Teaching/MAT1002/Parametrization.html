<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3D Vector Function Visualizer</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: #f8f9fa; }
    .sidebar { width: 320px; padding: 20px; background: white; box-shadow: 2px 0 10px rgba(0,0,0,0.1); z-index: 10; overflow-y: auto; }
    #main-content { flex-grow: 1; position: relative; }
    #plot { width: 100%; height: 100%; }
    .input-group { margin-bottom: 15px; }
    label { display: block; font-weight: bold; font-size: 0.9rem; color: #333; margin-bottom: 5px; }
    input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; font-family: monospace; }
    button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
    button:hover { background: #0056b3; }
    .header { border-bottom: 2px solid #eee; margin-bottom: 20px; padding-bottom: 10px; }
    .description { font-size: 0.85rem; color: #666; line-height: 1.4; }
  </style>
</head>
<body>

<div style="display: flex; height: 100%;">
  <div class="sidebar">
    <div class="header">
      <h2>3D Curves</h2>
      <p class="description">Visualize $\mathbf{r}(t) = \langle x(t), y(t), z(t) \rangle$</p>
    </div>

    <div class="input-group">
      <label>x(t)</label>
      <input type="text" id="xt" value="cos(t)">
    </div>
    <div class="input-group">
      <label>y(t)</label>
      <input type="text" id="yt" value="sin(t)">
    </div>
    <div class="input-group">
      <label>z(t)</label>
      <input type="text" id="zt" value="t/5">
    </div>

    <hr>

    <div class="input-group">
      <label>t range (min, max)</label>
      <div style="display: flex; gap: 5px;">
        <input type="number" id="tMin" value="0">
        <input type="number" id="tMax" value="12.5">
      </div>
    </div>

    <button onclick="plot3D()">Update Graph</button>

    <div style="margin-top: 20px; padding: 10px; background: #eef7ff; border-radius: 5px; font-size: 0.85rem;">
      <strong>Professor's Examples:</strong>
      <ul style="padding-left: 20px;">
        <li><b>Helix:</b> cos(t), sin(t), t/5</li>
        <li><b>Toroidal:</b> (2+cos(8t))*cos(t), (2+cos(8t))*sin(t), sin(8t)</li>
        <li><b>Astroid:</b> cos(t)^3, sin(t)^3, 0</li>
      </ul>
    </div>
  </div>

  <div id="main-content">
    <div id="plot"></div>
  </div>
</div>

<script>
function plot3D() {
  const xtExpr = document.getElementById('xt').value;
  const ytExpr = document.getElementById('yt').value;
  const ztExpr = document.getElementById('zt').value;
  const tMin = parseFloat(document.getElementById('tMin').value);
  const tMax = parseFloat(document.getElementById('tMax').value);

  const tVals = [];
  const xVals = [];
  const yVals = [];
  const zVals = [];

  const steps = 500;
  const dt = (tMax - tMin) / steps;

  for (let i = 0; i <= steps; i++) {
    const t = tMin + i * dt;
    try {
      tVals.push(t);
      xVals.push(math.evaluate(xtExpr, {t: t}));
      yVals.push(math.evaluate(ytExpr, {t: t}));
      zVals.push(math.evaluate(ztExpr, {t: t}));
    } catch (e) {
      console.error("Math error", e);
    }
  }

  const traceCurve = {
    x: xVals, y: yVals, z: zVals,
    type: 'scatter3d',
    mode: 'lines',
    line: { width: 6, color: tVals, colorscale: 'Viridis' },
    name: 'r(t)'
  };

  // Add a marker for the "head" of the vector at t_max
  const traceHead = {
    x: [xVals[xVals.length-1]], 
    y: [yVals[yVals.length-1]], 
    z: [zVals[zVals.length-1]],
    type: 'scatter3d',
    mode: 'markers',
    marker: { size: 8, color: 'red' },
    name: 'r(t_max)'
  };

  const layout = {
    scene: {
      xaxis: { title: 'X' },
      yaxis: { title: 'Y' },
      zaxis: { title: 'Z' }
    },
    margin: { l: 0, r: 0, b: 0, t: 0 },
    legend: { x: 0, y: 1 }
  };

  Plotly.newPlot('plot', [traceCurve, traceHead], layout, {responsive: true});
}

window.onload = plot3D;
</script>

</body>
</html>